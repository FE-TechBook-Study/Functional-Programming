### 이번 장에서 살펴볼 내용

- 함수형 도구 map(), filter(), reduce()에 대해 배운다.
- 배열에 대한 반복문을 함수형 도구로 바꾸는 방법에 대해 알아본다.
- 함수형 도구를 어떻게 구현하는지 알아본다.

# 코드 냄새 하나와 리팩터링 두 개

앞 장에서 리팩터링으로 코드에 중복을 없애고 더 좋은 추상화를 만들었다.

그리고 그 과정에서 일급 값과 고차 함수를 만들었다.

### 코드의 냄새: 함수 이름에 있는 암묵적 인자

이 코드의 냄새는 일급 값으로 바꾸면 표현력이 더 좋아진다. **함수 본문에서 사용하는 어떤 값이 함수 이름에 나타난다면 함수 이름에 있는 암묵적 인자는 코드의 냄새가 된다.** 아래에 나오는 리팩터링으로 해결할 수 있다.

**특징**

1. 거의 똑같이 구현된 함수가 있다.
2. 함수 이름이 구현에 있는 다른 부분을 가리킨다.

### 리팩터링: 암묵적 인자를 드러내기

암묵적 인자를 드러내기 리팩터링은 암묵적 인자가 일급 값이 되도록 함수에 인자를 추가한다.

이렇게 하면 잠재적 중복을 없애고 코드의 목적을 더 잘 표현할 수 있다.

**단계**

1. 함수 이름에 있는 암묵적 인자를 확인한다.
2. 명시적인 인자를 추가한다.
3. 함수 본문에 하드 코딩된 값을 새로운 인자로 바꾼다.
4. 함수를 호출하는 곳을 고친다.

### 리팩터링: 함수 본문을 콜백으로 바꾸기

함수 본문을 콜백으로 바꾸기 리팩터링으로 함수 본문에 어떤 부분(비슷한 함수에 있는 서로 다른 부분)을 콜백으로 바꾼다. 이렇게 하면 일급 함수로 어떤 함수에 동작을 전달할 수 있다.

이 방법은 원래 있던 코드를 고차 함수로 만드는 가장 강력한 방법이다.

**단계**

1. 함수 본문에서 바꿀 부분의 앞부분과 뒷부분을 확인한다.
2. 리팩터링 할 코드를 함수로 빼낸다.
3. 빼낸 함수의 인자로 넘길 부분을 또 다른 함수로 빼낸다.

## reduce 함수를 사용할 때, 초깃값을 결정하는 방법

1. 계산이 어떤 값에서 시작하는가
2. 빈 배열을 사용하면 어떤 값을 리턴할 것인가
3. 비즈니스 규칙이 있는가

## reduce로 할 수 있는 것들

### 실행 취소/실행 복귀

리스트 형태의 사용자 입력에 reduce()를 적용한 것이 현재 상태라고 생각해 보면, 실행 취소는 리스트의 마지막 사용자 입력을 없애는 것이라고 할 수 있다.

### 테스트할 때 사용자 입력을 다시 실행하기

시스템의 처음 상태가 초깃값이고 사용자 입력이 순서대로 리스트에 있을 때 reduce()로 모든 값을 합쳐 현재 상태를 만들 수 있다.

### 시간 여행 디버깅

변경 사항을 어떤 시점으로 되돌릴 수 있다.

### 회계 감사 추적

과거에 어떤 일이 있었는지 기록할 수 있다. 어떤 과정을 통해 일이 생겼는지도 알 수 있다.

# reduce로 filter와 map 구현하기

```tsx
const userInputList = [1, 2, 3, 4, 5];

const customFilter = (array, conditionFn) => {
  return array.reduce((acc, cur) => {
    if (conditionFn(cur)) {
      acc.push(cur);
    }
    return acc;
  }, []);
};

const isEven = (num) => num % 2 === 0;
const filteredList = customFilter(userInputList, isEven);

console.log(filteredList); // 결과: [2, 4]
```

```tsx
const userInputList = [1, 2, 3, 4, 5];

const customMap = (array, transformFn) => {
  return array.reduce((acc, cur) => {
    acc.push(transformFn(cur));
    return acc;
  }, []);
};

const multiplyByTwo = (num) => num * 2;
const mappedList = customMap(userInputList, multiplyByTwo);

console.log(mappedList); // 결과: [2, 4, 6, 8, 10]
```
